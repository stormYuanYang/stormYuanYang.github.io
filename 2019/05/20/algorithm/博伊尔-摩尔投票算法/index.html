<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=0.5"><link rel="stylesheet" href="/css/post.css"><link rel="icon" href="/img/favicon.png"><title>博伊尔-摩尔投票算法</title><meta name="generator" content="Hexo 6.0.0"></head><body>　　<div class="inner"><h2>博伊尔-摩尔投票算法</h2><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>博伊尔-摩尔投票算法原称“<strong>Boyer-Moore majority vote algorithm</strong>”，很多同学将其称呼为<strong>摩尔投票算法</strong>，这是不对和不公平的，我们应对计算机前辈有起码的尊重，不要忘记此算法的另一位发明者:<strong>Boyer</strong>。 <strong>博伊尔-摩尔投票算法</strong>在下文中简称<strong>投票算法</strong>，请知悉。<strong>投票算法</strong>由<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Robert_S._Boyer">Robert S. Boyer</a>和<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/J_Strother_Moore">J Strother Moore</a>于1981年发明。</p>
<h1 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h1><p><strong>投票算法</strong>目的是在<strong>线性时间</strong>复杂度和<strong>常量</strong>空间复杂度内找到<strong>序列</strong>中的<strong>majority element</strong>。什么是<strong>majority element</strong>？我将其翻译为<strong>主要元素</strong>，简称<strong>主元</strong>，注意不要混淆数学上的<strong>主元</strong>含义（数学上有个术语<strong>众数</strong>，其概念和此类似）。本文中的<strong>主元</strong>指，在<strong>序列</strong>中出现次数超过一半的<strong>元素</strong>。 如果我们需要找到<strong>序列</strong>中出现次数超过一半的<strong>元素</strong>(此时也是出现次数<strong>最多</strong>的元素)，也就是<strong>主元</strong>，就可以采用<strong>投票算法</strong>。 <strong>投票算法</strong>能在序列中找到<strong>主元</strong>的前提是序列中存在<strong>主元</strong>。不论序列中是否存在<strong>主元</strong>，<strong>投票算法</strong>都会找到一个元素：</p>
<ul>
<li>如果序列中存在<strong>主元</strong>，则此元素就是<strong>主元</strong>；</li>
<li>否则，此元素不是<strong>主元</strong>。</li>
</ul>
<p>那不知道序列中是否存在<strong>主元</strong>时，如何判断<strong>投票算法</strong>找到的元素是否是主元呢？很简单，只需要对序列再次遍历，计算<strong>投票算法</strong>找到的元素出现的次数：</p>
<ul>
<li>如果次数大于序列中元素数量的一半，此元素就是<strong>主元</strong>；</li>
<li>否则，不是。</li>
</ul>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p><strong>投票算法</strong>的原理是比较简单的。用一个例子来说明投票算法的原理： 小明所在班级要选出一位班长；小明的班主任邓老师因为小明平时热爱学习和思考，为人大方、团结同学就推荐小明做这个班长；邓老师为了公平，要求全班同学投票，可以投赞成票、反对票、弃权票（投票选项写在卡片上），如果投票数超过全班人数的一半，则小明就被任命为班长；否则，小明就不能被任命为班长。现在，投票活动已经结束，所有的投票卡片已经收集完毕，现在邓老师决定让班级中成绩最好的小杨来统计投票结果。 小杨支着下巴，陷入了沉思：我如何找到投票数超过一半的选项呢？投赞成票的是赞成派，投反对票的是反对派，投弃权票的是弃权派；对于每一派来说，只关心投票的人是不是自己这一派，到底是其他哪一派并不关心。那我是不是可以这样统计：</p>
<ol>
<li>建立一个<strong>计数器</strong>初始化为0，并遍历所有的投票卡片；</li>
<li>选取一张未统计的卡片，如果计数器当前为0，则计数器加1，并记录下当前卡片对应的选项；否则，计数器一定是大于0的，说明计数器已经记录了某一选项的投票数，如果当前卡片的选项和计数器代表的选项是一样的，则计数器加1，否则计数器减1。</li>
<li>重复步骤2，直到所有投票卡片都已统计完毕；统计完毕后，我根据计数器的数量而记录下的卡片选项x就一定是投票数超过一半的选项；哦，不对，不一定是投票数超过一半的选项；我需要再次遍历所有的投票卡片，统计x的数量，就能知道x是不是大于投票数的一半了。</li>
</ol>
<p>小杨直觉这样能找到，投票数超过一半的选项，但是不知道方法对不对，所以他去请教了邓老师，有了如下对话： 邓老师：“小杨啊，你这样想是正确的，而且你和计算机前辈的想法不谋而合。” 小杨：“啥？我这么厉害。” 邓老师：“哈哈。是的，你这个想法早就有人提出来了，叫做<strong>博伊尔-摩尔投票算法</strong>。这个算法的目的就是找到在投票中出现超过一半的选项啦。” 小杨：“但是，邓老师，如何证明这个算法的正确性呢？” “咳咳”，邓老师咳了一下，抿了一口浓茶，慢慢说道：“咱们先假设投票选项中有超过一半人数的选项，我们将此称为<strong>主元</strong>；对于主元来说，非主元的数量一定是小于主元的；你建立一个计数器，并记录下当前计数器对应的卡片选项，如果接下来的卡片选项是不同的就更新计数器（计数器为0时）对应的选项或者计数器直接减1（计数器大于0时）；这样在遍历卡片的过程中，不同的投票选项相互抵消，最后剩下的数量大于0的选项就一定是<strong>主元</strong>啦，你说是不是。” 小杨沉思片刻后说：“哦！原来是这样。对于选项来说，它只关心下一个选项是不是和自己相同，相同的话，计数器就加1；不同的话，就相互抵消了。这样最后剩下的肯定是<strong>主元</strong>，但这是建立在有<strong>主元</strong>的前提下，所以的到的结果不一定是正确的，我们可以再遍历一次卡片选项，看看得到的选项的数量是否超过了总数的一半。” 邓老师：“是的，你说的没错。如果我们不能确保有<strong>主元</strong>的话，就需要验证。” 小杨又想了想，说道：“邓老师，<strong>投票算法</strong>优势应该是在有很多种不同意见时，只通过遍历一次所有的意见就能知道超过一半的意见，并且通过再次遍历就可以验证。” 邓老师露出了满意的笑容：“对的，<strong>投票算法</strong>的优势就在于此。学习算法就是要多思考，你做得很不错。那你能告诉我<strong>投票算法</strong>的时间复杂度和空间复杂度吗？” 小杨：“没问题。<strong>投票算法</strong>，最多遍历两次序列，而且只会用到常量空间。所以<strong>投票算法</strong>的时间复杂度是$O(n)$，空间复杂度是$O(1)$。” 邓老师很满意地笑道：“不错，不错，分析地完全正确。那我现在给你留个作业。用代码实现<strong>投票算法</strong>。” 第二天，小杨以lua代码完成了作业，并将作业交给了邓老师，作业被邓老师分享给全班同学参考。 让我们一起看看小杨的作业：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">local</span> majority</span><br><span class="line"><span class="keyword">local</span> count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #t <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> count == <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        majority = t[i]</span><br><span class="line">        count = count + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">if</span> majority == t[i] <span class="keyword">then</span></span><br><span class="line">            count = count + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            count = count - <span class="number">1</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(majority)</span><br></pre></td></tr></table></figure>

<p>是不是非常简单呢？:-)</p>
<h1 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h1><p>维基百科：<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_majority_vote_algorithm"><strong>Boyer-Moore majority vote algorithm</strong></a></p>
<p><span></span><a href="/">返回首页</a><span></span></p></div><script src="/js/jquery.min.js"></script><script src="/js/main.js"></script></body></html>